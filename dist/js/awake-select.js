"use strict";function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Map"===(n="Object"===n&&e.constructor?e.constructor.name:n)||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}function _classPrivateMethodInitSpec(e,t){_checkPrivateRedeclaration(e,t),t.add(e)}function _classPrivateFieldInitSpec(e,t,n){_checkPrivateRedeclaration(e,t),t.set(e,n)}function _checkPrivateRedeclaration(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet(e,t){return _classApplyDescriptorGet(e,_classExtractFieldDescriptor(e,t,"get"))}function _classExtractFieldDescriptor(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}function _classApplyDescriptorGet(e,t){return t.get?t.get.call(e):t.value}function _classPrivateMethodGet(e,t,n){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return n}var _getMultipleTemplate=new WeakMap,_getTemplate=new WeakMap,_render=new WeakSet,_assign=new WeakSet,AwakeSelect=function(){function n(e,t){_classCallCheck(this,n),_classPrivateMethodInitSpec(this,_assign),_classPrivateMethodInitSpec(this,_render),_classPrivateFieldInitSpec(this,_getMultipleTemplate,{writable:!0,value:function(e){e=_toConsumableArray(e.querySelectorAll("option")).map(function(e){if(e.selected)return'<li class="aw-select__multiple-item" data-value="'.concat(e.value,'" data-type="multiple-option">\n            ').concat(e.textContent,"\n        </li>")});return e?e.join(""):null}}),_classPrivateFieldInitSpec(this,_getTemplate,{writable:!0,value:function(e,t,i){var n=_toConsumableArray(e.querySelectorAll("option")).map(function(e,t){var n;return'\n     <li class="aw-select__dropdown--item '.concat(e.selected?"chosen":"",'" data-type="option" data-value="').concat(e.value,'">\n        ').concat(e.textContent,'\n        <span class="aw-select__dropdown--item-customContent" style="pointer-events: none">').concat(0<(null===(e=i.customOptionsText)||void 0===e?void 0:e.length)&&null!==(n=i.customOptionsText[t])&&void 0!==n?n:"","</span>\n    </li>\n    ")});return'<div class="aw-select__single '.concat(null!==(e=i.position)&&void 0!==e?e:"",'" data-type="single" role="button">\n        <span class="aw-select__single--text" style="pointer-events: none" data-type="text">').concat(null!=t?t:"Choose an option",'</span>\n        <span class="aw-select__single--arrow" style="pointer-events: none" data-type="arrow"></span>\n    </div>\n    <ul class="aw-select__dropdown ').concat(null!==(t=i.position)&&void 0!==t?t:"","  ").concat(i.animation?"animation":"",'" aria-expanded="false" aria-hidden="true" style="').concat("top"===i.position?'top: "100%";':""," ").concat("bottom"===i.position?'bottom: "100%";':"",'">\n        ').concat(i.search?'<input class="aw-select__dropdown--input" type=\'text\' data-search placeholder="'.concat(null!==(t=i.placeholder_text)&&void 0!==t?t:"Type your text...",'">'):"","\n        ").concat(n.join(""),"\n    </ul>\n  ")}}),this.$select=document.querySelector(e),this.$options=t,this.$options.animation=null!==(t=this.$options.animation)&&void 0!==t&&t,this.$options.animationDuration=this.$options.animationDuration?+this.$options.animationDuration/1e3:.2,this.$options.position=null!==(t=this.$options.position)&&void 0!==t?t:"auto",this.$newSelect=null,this.$multipleSelect=null,this.$multipleSelectOptionsChosen=null,this.$searchInput=null,this.$dropdownHeight=0,this.$options.multiple=null!==(t=this.$options.multiple)&&void 0!==t&&t,console.log(this.$select),this.$select&&0<this.$select.querySelectorAll("option").length?(_classPrivateMethodGet(this,_render,_render2).call(this),_classPrivateMethodGet(this,_assign,_assign2).call(this)):"select"!==this.$select.tagName.toLowerCase()?console.error("Element ".concat(e," is not tag select")):console.error("There is no element like ".concat(e," or option length equals to 0"))}return _createClass(n,[{key:"getElementPositionCoords",value:function(e){e=e.getBoundingClientRect();return{top:e.top+pageYOffset,bottom:pageYOffset+document.documentElement.clientHeight-e.top}}},{key:"removeSearchValue",value:function(){this.$options.search&&this.$searchInput&&(this.$searchInput.value="",this.$newSelect.querySelectorAll('li[data-type="option"]').forEach(function(e){return e.style.display="block"}))}},{key:"addingClassForDropdownPosition",value:function(){var e=this.$newSelect.querySelector(".aw-select__dropdown"),t=this.$newSelect.querySelector(".aw-select__single"),n=this.getDropdownPosition();n&&(e.classList.remove("bottom-position","top-position"),t.classList.remove("bottom-position","top-position"),e.classList.add(n),t.classList.add(n))}},{key:"clickOutsideHandler",value:function(e){e.target.closest(".aw-select")||(this.close(),this.removeSearchValue(),document.removeEventListener("click",this.clickOutsideHandler))}},{key:"multipleItemClickHandler",value:function(e){var t=e.target,n=t.dataset,e=n.type,i=n.value;"multiple-option"===e&&(_toConsumableArray(this.$select.querySelectorAll("option")).find(function(e){e.value===i&&(e.selected=!1)}),_toConsumableArray(this.$newSelect.querySelectorAll('li[data-type="option"]')).find(function(e){e.dataset.value===i&&e.classList.remove("chosen")}),t.remove())}},{key:"clickHandler",value:function(e){var n,i=this,t=e.target.dataset.type;"single"===t&&this.toggle(),"option"===t&&(n=e.target,this.$options.multiple?_toConsumableArray(this.$select.querySelectorAll("option")).find(function(e){var t;e.value===n.dataset.value&&(n.classList.contains("chosen")?(n.classList.remove("chosen"),e.selected=!1,_toConsumableArray(i.$multipleSelectOptionsChosen.querySelectorAll(".aw-select__multiple-item")).find(function(e){e.dataset.value===n.dataset.value&&e.remove()})):(n.classList.add("chosen"),e.selected=!0,(t=document.createElement("li")).classList.add("aw-select__multiple-item"),t.setAttribute("data-value",e.value),t.textContent=e.textContent,i.$multipleSelectOptionsChosen.append(t)))}):(n.parentNode.querySelectorAll(".aw-select__dropdown--item").forEach(function(e){return e.classList.remove("chosen")}),n.classList.add("chosen"),this.$select.value=e.target.dataset.value,this.$newSelect.querySelector(".aw-select__single--text").textContent=n.childNodes[0].textContent,this.removeSearchValue(),this.close()))}},{key:"searchInputHandler",value:function(e){var t=e.target.value,n=this.$newSelect.querySelectorAll(".aw-select__dropdown--item");n&&(e=_toConsumableArray(n).filter(function(e){if(e.textContent.toLowerCase().includes(t.toLowerCase().trim()))return e}),0<t.length?(n.forEach(function(e,t){e.style.display="none"}),e.forEach(function(e){e.style.display="block"})):n.forEach(function(e,t){e.style.display="block"}))}},{key:"dropdownPositionResizeHandler",value:function(){"auto"===this.$options.position&&this.addingClassForDropdownPosition()}},{key:"isOpen",get:function(){return this.$newSelect.classList.contains("open")}},{key:"toggle",value:function(){this.isOpen?(document.removeEventListener("click",this.clickOutsideHandler),this.close()):(this.open(),document.addEventListener("click",this.clickOutsideHandler))}},{key:"getDropdownPosition",value:function(){var e,t=this.$newSelect.querySelector(".aw-select__dropdown").clientHeight;return this.getElementPositionCoords(this.$newSelect).bottom<t&&(e="bottom-position"),e=this.getElementPositionCoords(this.$newSelect).top<t?"top-position":e}},{key:"open",value:function(){var e=this.$newSelect.querySelector(".aw-select__dropdown"),t=document.querySelectorAll(".aw-select");t&&t.forEach(function(e){return e.classList.remove("open")}),this.$options.animation&&(e.style.height=this.$dropdownHeight+"px",this.$newSelect.querySelector(".aw-select__dropdown").style.transition="all ".concat(this.$options.animationDuration.toString(),"s")),this.$newSelect.classList.add("open"),e.setAttribute("aria-expanded","true"),e.setAttribute("aria-hidden","false")}},{key:"close",value:function(){var e=this.$newSelect.querySelector(".aw-select__dropdown");this.$newSelect.classList.remove("open"),e.scrollTo({top:0,behavior:"auto"}),this.$options.animation&&(this.$newSelect.querySelector(".aw-select__dropdown").style.height="0",this.$newSelect.querySelector(".aw-select__dropdown").style.transition="all ".concat(this.$options.animationDuration.toString(),"s")),this.$newSelect.querySelector(".aw-select__dropdown").setAttribute("aria-expanded","false"),e.setAttribute("aria-hidden","true")}},{key:"destroy",value:function(){this.$newSelect.removeEventListener("click",this.clickHandler),this.$newSelect.remove(),this.$select.style.display="block"}}]),n}();function _render2(){var e,t,n,i=this;this.$select.style.display="none",this.$select.value&&(t=_toConsumableArray(this.$select.querySelectorAll("option")).find(function(e){return e.value.toLowerCase().trim()===i.$select.value.toLowerCase().trim()}).textContent),console.log(t),this.$newSelect=document.createElement("div"),this.$newSelect.classList.add("aw-select"),this.$newSelect.innerHTML=_classPrivateFieldGet(this,_getTemplate).call(this,this.$select,null!==(e=this.$options.defaultValue)&&void 0!==e?e:t,this.$options),this.$select.parentNode.insertBefore(this.$newSelect,this.$select.nextSibling),this.$options.multiple&&(this.$multipleSelect=document.createElement("div"),this.$multipleSelectOptionsChosen=document.createElement("div"),this.$multipleSelect.classList.add("aw-multiple-select"),this.$multipleSelectOptionsChosen.classList.add("aw-multiple-select-chosen"),this.$select.parentNode.insertBefore(this.$multipleSelect,this.$select.nextSibling),n=this.$multipleSelect.querySelector(".aw-select"),this.$multipleSelect.insertBefore(this.$multipleSelectOptionsChosen,n),this.$multipleSelectOptionsChosen.innerHTML=_classPrivateFieldGet(this,_getMultipleTemplate).call(this,this.$select),this.$multipleSelect.appendChild(this.$newSelect)),this.$dropdownHeight=this.$newSelect.querySelector(".aw-select__dropdown").clientHeight,"auto"===this.$options.position&&this.addingClassForDropdownPosition(),this.$options.animation&&(this.$newSelect.querySelector(".aw-select__dropdown").style.height="0"),this.$searchInput=null!==(n=this.$newSelect.querySelector("input[data-search]"))&&void 0!==n?n:null}function _assign2(){this.clickHandler=this.clickHandler.bind(this),this.searchInputHandler=this.searchInputHandler.bind(this),this.clickOutsideHandler=this.clickOutsideHandler.bind(this),this.dropdownPositionResizeHandler=this.dropdownPositionResizeHandler.bind(this),this.$options.multiple&&(this.multipleItemClickHandler=this.multipleItemClickHandler.bind(this),this.$multipleSelectOptionsChosen.addEventListener("click",this.multipleItemClickHandler)),this.$newSelect.addEventListener("click",this.clickHandler),"auto"===this.$options.position&&window.addEventListener("resize",this.dropdownPositionResizeHandler),this.$searchInput&&this.$searchInput.addEventListener("input",this.searchInputHandler)}